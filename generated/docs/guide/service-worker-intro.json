{"id":"guide/service-worker-intro","title":"Angular service worker introduction","contents":"\n\n\n  <div class=\"github-links\">\n    <a href=\"https://github.com/angular/angular-cn/edit/aio/aio/content/guide/service-worker-intro.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n  </div>\n\n\n<div class=\"content\">\n<h1 id=\"angular-service-worker-introduction\" translation-result=\"on\">Angular 的 Service Worker 简介<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#angular-service-worker-introduction\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\" id=\"angular-service-worker-introduction\">Angular service worker introduction<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#angular-service-worker-introduction\"><i class=\"material-icons\">link</i></a></h1>\n\n<p translation-result=\"on\">Service Worker 可以增强传统的 Web 发布模式，并使应用程序能够提供可与本机代码媲美的高可靠、高性能的用户体验。为 Angular 应用添加 Service Worker 是把应用转换成<a href=\"https://developers.google.com/web/progressive-web-apps/\">渐进式应用（PWA）</a>的步骤之一。</p><p translation-origin=\"off\">Service workers augment the traditional web deployment model and empower applications to deliver a user experience with the reliability and performance on par with natively-installed code. Adding a service worker to an Angular application is one of the steps for turning an application into a <a href=\"https://developers.google.com/web/progressive-web-apps/\">Progressive Web App</a> (also known as a PWA).</p>\n\n<p translation-result=\"on\">简单来说，Service Worker 就是一段运行在 Web 浏览器中，并为应用管理缓存的脚本。</p><p translation-origin=\"off\">At its simplest, a service worker is a script that runs in the web browser and manages caching for an application.</p>\n\n<p translation-result=\"on\">Service Worker 的功能就像一个网络代理。它们会拦截所有由应用发出的 HTTP 请求，并选择如何给出响应。\n比如，它们可以查询局部缓存，如果有缓存的响应数据，就用它做出响应。\n这种代理行为不会局限于通过程序调用 API（比如<code>fetch</code>）发起的请求，还包括 HTML 中对资源的引用，甚至对 <code>index.html</code> 的首次请求。\n基于 Service Worker 的缓存是完全可编程的，并且不依赖于服务端指定的那些控制缓存策略的头。</p><p translation-origin=\"off\">Service workers function as a network proxy. They intercept all outgoing HTTP requests made by the application and can choose how to respond to them. For example, they can query a local cache and deliver a cached response if one is available. Proxying isn't limited to requests made through programmatic APIs, such as <code>fetch</code>; it also includes resources referenced in HTML and even the initial request to <code>index.html</code>. Service worker-based caching is thus completely programmable and doesn't rely on server-specified caching headers.</p>\n\n<p translation-result=\"on\">不像应用中的其它脚本（如 Angular 的应用包），Service Worker 在用户关闭浏览器页标签时仍然会被保留。\n下次浏览器加载本应用时，Service Worker 会首先加载，然后拦截加载本应用时的对每一项资源的请求。\n如果这个 Service Worker 就是为此而设计的，它就能<em>完全满足应用加载时的需求，而不需要依赖网络</em>。</p><p translation-origin=\"off\">Unlike the other scripts that make up an application, such as the Angular app bundle, the service worker is preserved after the user closes the tab. The next time that browser loads the application, the service worker loads first, and can intercept every request for resources to load the application. If the service worker is designed to do so, it can <em>completely satisfy the loading of the application, without the need for the network</em>.</p>\n\n<p translation-result=\"on\">即使在快速可靠的网络中，往返延迟也可能在加载应用程序时产生显著的延迟。使用 Service Worker 来减少对网络的依赖可以显着改善用户体验。</p><p translation-origin=\"off\">Even across a fast reliable network, round-trip delays can introduce significant latency when loading the application. Using a service worker to reduce dependency on the network can significantly improve the user experience.</p>\n\n<h2 id=\"service-workers-in-angular\" translation-result=\"on\">Angular 中的 Service Worker<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#service-workers-in-angular\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"service-workers-in-angular\">Service workers in Angular<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#service-workers-in-angular\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">作为单页面应用，Angular 应用可以受益于 Service Worker 的优势。\n从 Angular v5.0.0 开始，Angular 提供了一份 Service Worker 的实现。\nAngular 开发人员可以利用 Service Worker，并受益于其增强的可靠性和性能，而无需再针对底层 API 写代码。</p><p translation-origin=\"off\">Angular applications, as single-page applications, are in a prime position to benefit from the advantages of service workers. Starting with version 5.0.0, Angular ships with a service worker implementation. Angular developers can take advantage of this service worker and benefit from the increased reliability and performance it provides, without needing to code against low-level APIs.</p>\n\n<p translation-result=\"on\">Angular 的 Service Worker 的设计目标是优化那些使用慢速、不可靠网络的最终用户的体验，同时还要尽可能减小提供过期内容的风险。</p><p translation-origin=\"off\">Angular's service worker is designed to optimize the end user experience of using an application over a slow or unreliable network connection, while also minimizing the risks of serving outdated content.</p>\n\n<p translation-result=\"on\">Angular 的 Service Worker 的行为遵循下列设计目标：</p><p translation-origin=\"off\">The Angular service worker's behavior follows that design goal:</p>\n\n<ul>\n<li>\n<p translation-result=\"on\"> 像安装原生应用一样缓存应用。该应用作为整体被缓存，它的所有文件作为整体进行更新。</p><p translation-origin=\"off\">Caching an application is like installing a native application. The application is cached as one unit, and all files update together.</p>\n\n</li>\n<li>\n<p translation-result=\"on\"> 正在运行的应用使用所有文件的同一版本继续运行。不要突然开始接收来自新版本的、可能不兼容的缓存文件。</p><p translation-origin=\"off\">A running application continues to run with the same version of all files. It does not suddenly start receiving cached files from a newer version, which are likely incompatible.</p>\n\n</li>\n<li>\n<p translation-result=\"on\"> 当用户刷新本应用时，他们会看到最新的被完全缓存的版本。新的页标签中会加载最新的缓存代码。</p><p translation-origin=\"off\">When users refresh the application, they see the latest fully cached version. New tabs load the latest cached code.</p>\n\n</li>\n<li>\n<p translation-result=\"on\"> 在更改发布之后，相对较快的在后台进行更新。在一次完整的更新完成之前，仍然使用应用的上一个版本。</p><p translation-origin=\"off\">Updates happen in the background, relatively quickly after changes are published. The previous version of the application is served until an update is installed and ready.</p>\n\n</li>\n<li>\n<p translation-result=\"on\"> 只要有可能，Service Worker 就会尽量节省带宽。它只会下载那些发生了变化的资源。</p><p translation-origin=\"off\">The service worker conserves bandwidth when possible. Resources are only downloaded if they've changed.</p>\n\n</li>\n</ul>\n<p translation-result=\"on\">要支持这些行为，Angular 的 Service Worker 会从服务器上下载一个 <code>manifest</code> 文件。\n这个 <code>manifest</code> 文件描述要缓存的资源，并包含每个文件内容的哈希值。\n当发布了应用的一个新版本时，<code>manifest</code> 的内容就会改变，通知 Service Worker 应该下载并缓存应用的一个新版本了。\n这个 manifest 是从 CLI 生成的一个名叫 <code>ngsw-config.json</code> 的文件中生成的。</p><p translation-origin=\"off\">To support these behaviors, the Angular service worker loads a <em>manifest</em> file from the server. The manifest describes the resources to cache and includes hashes of every file's contents. When an update to the application is deployed, the contents of the manifest change, informing the service worker that a new version of the application should be downloaded and cached. This manifest is generated from a CLI-generated configuration file called <code>ngsw-config.json</code>.</p>\n\n<p translation-result=\"on\">安装 Angular 的 Service Worker 就像引入一个 <code><a href=\"api/core/NgModule\" class=\"code-anchor\">NgModule</a></code> 一样简单。\n除了使用浏览器注册 Angular 的 Service Worker 之外，还要制作一些可供注入的服务，它们可以与 Service Worker 交互，并控制它。\n比如，应用可以要求当新的更新已经就绪时通知自己，或要求 Service Worker 检查服务器，看是否有可用的更新。</p><p translation-origin=\"off\">Installing the Angular service worker is as simple as including an <code><a href=\"api/core/NgModule\" class=\"code-anchor\">NgModule</a></code>. In addition to registering the Angular service worker with the browser, this also makes a few services available for injection which interact with the service worker and can be used to control it. For example, an application can ask to be notified when a new update becomes available, or an application can ask the service worker to check the server for available updates.</p>\n\n<h2 id=\"prerequisites\" translation-result=\"on\">前提条件<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#prerequisites\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"prerequisites\">Prerequisites<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#prerequisites\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">你的应用必须运行在支持 Service Worker 的 Web 浏览器中。目前，Chrome 和 Firefox 的最新版本 都已经支持了。\n要想知道其它浏览器是否支持，参见 <a href=\"http://caniuse.com/#feat=serviceworkers\">Can I Use</a> 页。</p><p translation-origin=\"off\">Your application must run in a web browser that supports service workers. Currently, service workers are supported in the latest versions of Chrome, Firefox, Edge, Safari, Opera, UC Browser (Android version) and Samsung Internet. Browsers like IE and Opera Mini do not provide the support. To learn more about other browsers that are service worker ready, see the <a href=\"https://caniuse.com/#feat=serviceworkers\">Can I Use</a> page and <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\">MDN docs</a>.</p>\n\n<p translation-result=\"on\">此外，为了注册 Service Worker，应用必须通过 HTTPS 进行访问，而不能通过 HTTP。浏览器会忽略那些通过不安全连接提供的页面上的 Service Worker。其原因在于 Service Worker 真的很强大，所以需要额外的安全保障来确保 Service Worker 脚本不会被中间人攻击所篡改。</p><p translation-origin=\"off\">In addition, in order for service workers to be registered, the app must be accessed over HTTPS, not HTTP. Browsers will ignore service workers on pages that are served over an insecure connection. The reason is that service workers are quite powerful, so extra care needs to be taken to ensure the service worker script has not been tampered with.</p>\n\n<p translation-result=\"on\">这条规则有一个例外：为了方便本地开发，当访问 <code>localhost</code> 上的应用时，浏览器<em>不</em>要求安全连接。</p><p translation-origin=\"off\">There is one exception to this rule: To make local development easier, browsers do <em>not</em> require a secure connection when accessing an app on <code>localhost</code>.</p>\n\n<h2 id=\"related-resources\" translation-result=\"on\">相关资源<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#related-resources\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"related-resources\">Related resources<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#related-resources\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">要了解更多关于 Service Worker 的普遍性信息，参见 <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/\">Service Worker 简介</a>。</p><p translation-origin=\"off\">For more information about service workers in general, see <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/\">Service Workers: an Introduction</a>.</p>\n\n<p translation-result=\"on\">要了解关于浏览器支持度的更多信息，参见 <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/\">Service Worker 简介</a> 中的<a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/#browser_support\">浏览器支持</a>部分、Jake Archibald 写的<a href=\"https://jakearchibald.github.io/isserviceworkerready/\">Serviceworker 好了吗？</a>和 <a href=\"http://caniuse.com/#feat=serviceworkers\">Can I Use</a>。</p><p translation-origin=\"off\">For more information about browser support, see the <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/#browser_support\">browser support</a> section of <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/\">Service Workers: an Introduction</a>, Jake Archibald's <a href=\"https://jakearchibald.github.io/isserviceworkerready/\">Is Serviceworker ready?</a>, and\n<a href=\"http://caniuse.com/#feat=serviceworkers\">Can I Use</a>.</p>\n\n<p translation-result=\"on\">这份 Angular 文档的其它部分全都专注于讲 Angular 中的 Service Worker 实现。</p><p translation-origin=\"off\">The remainder of this Angular documentation specifically addresses the Angular implementation of service workers.</p>\n\n<h2 id=\"more-on-angular-service-workers\" translation-result=\"on\">关于 Angular Service Worker 的更多信息<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#more-on-angular-service-workers\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"more-on-angular-service-workers\">More on Angular service workers<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-intro#more-on-angular-service-workers\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">你可能还对下列内容感兴趣：</p><p translation-origin=\"off\">You may also be interested in the following:</p>\n\n<ul>\n<li>\n<p translation-result=\"on\"> <a href=\"guide/service-worker-getting-started\">Service Worker 快速起步</a>。</p><p translation-origin=\"off\"><a href=\"guide/service-worker-getting-started\">Getting Started with service workers</a>.</p>\n\n</li>\n</ul>\n\n</div>\n\n<!-- links to this doc:\n - api/service-worker\n - guide/architecture-next-steps\n - guide/glossary\n - guide/libraries\n - guide/service-worker-getting-started\n-->\n<!-- links from this doc:\n - api/core/NgModule\n - guide/service-worker-getting-started\n - guide/service-worker-intro#angular-service-worker-introduction\n - guide/service-worker-intro#more-on-angular-service-workers\n - guide/service-worker-intro#prerequisites\n - guide/service-worker-intro#related-resources\n - guide/service-worker-intro#service-workers-in-angular\n - http://caniuse.com/#feat=serviceworkers\n - https://caniuse.com/#feat=serviceworkers\n - https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\n - https://developers.google.com/web/fundamentals/primers/service-workers/\n - https://developers.google.com/web/fundamentals/primers/service-workers/#browser_support\n - https://developers.google.com/web/progressive-web-apps/\n - https://github.com/angular/angular-cn/edit/aio/aio/content/guide/service-worker-intro.md?message=docs%3A%20请简述你的修改...\n - https://jakearchibald.github.io/isserviceworkerready/\n-->"}